<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Melo</title>
    <!-- Load FontAwesome icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.13.0/css/all.min.css">
    <!--   <script src="../node_modules/nw-dev/lib/dev.js"></script> -->
    <!-- script type="module" src="main.js" defer></script> -->
    <!--  <script src="functions.js"></script> -->
    <!-- CSS style -->
    <style>
  /* Forbid dragging of interface elements */
  *{
    user-select: none;       
    -webkit-user-drag: none;    
  }
  body {
    background-color: rgb(255, 255, 255);
    margin:0px;
    transition: background-color .5s;
    overflow: hidden;
  }
  .seek_slider::-moz-range-thumb  {
    background: url('https://cdn-icons-png.flaticon.com/24/54/54601.png');
    background-repeat: repeat;
    cursor: pointer;
    width: 6px;
    height: 24px;
    border: none;
    -webkit-appearance: none;
    appearance: none;
    background-repeat: no-repeat;
    padding: 9px;
  }
  ::-webkit-scrollbar {
    width: 10px;
    height:10px;
  }
  ::-webkit-scrollbar-track {
    box-shadow: inset 0 0 1px grey; 
    border-radius: 10px;
  }
  .darkMe2::-webkit-scrollbar-thumb {
    background: gray; 
    border-radius: 10px;
  }
  /* If light mode is on, change slider color */
  ::-webkit-scrollbar-thumb {
    background: #dcdcdc; 
    border-radius: 10px;
  }
/*   ::-webkit-scrollbar-thumb:hover {
    background: #dcdcdc; 
  } */
  /*Video container */
  .details {
    right: 0px;
    left: 0px;
    bottom: 0px;
    top: 0px;
    margin: auto;
    position: absolute;
    z-index: 200;
  }
  /* Track image */
  .track-art {
    position: absolute;
    top: 134px;
    margin: 0px;
    height: 220px;
    width: 220px;
    border-radius: 15%;
    padding: 10px;
    left: 11px;
  }
  .now-playing {
    font-size: 1rem;
  }
  .track-name {
    font-size: 1.6em;
  }
  .track-artist {
    font-size: 1.3rem;
  }
  .buttons {
    display: flex;
    flex-direction: row;
    align-items: center;
    border-radius: 40px;
    padding: 2px;
    justify-content: center;
  }
  .volume_slider{
    bottom: 109px;
    right: -47px;
  }
  .playpause-track,
  .prev-track,
  .next-track {
    padding-inline: 1px;
    opacity: 0.4;
    transition: opacity .2s;
  }
  .playpause-track:hover,
  .prev-track:hover,
  .next-track:hover {
    opacity: 1.0;
  }
  .slider_container {
    width: 100%;
    background: #dddddd70;
    display: flex;
    justify-content: center;
    align-items: center;
    bottom: 0px;
    z-index: 200;
    position: absolute;
    /* filter: invert(1); */
  }
  .slider2 {
    height: 35px;
  }
  .slider2 div {
    padding-inline:20px;
  }
  /* Modify the appearance of the slider */
  .seek_slider,
  .volume_slider {
    border-radius: 20px;
    height: 3px;
    background: black;
    accent-color: black;
    opacity: 0.7;
    -webkit-transition: .2s;
    transition: opacity .2s;
  }
  .yes{
    margin:0px
  }

  /* Modify the appearance of the slider thumb */
  .seek_slider::-webkit-slider-thumb,
  .volume_slider::-moz-range-thumb {
    background: url('https://cdn-icons-png.flaticon.com/24/54/54601.png');
    background-repeat: repeat;
    cursor: pointer;
    width: 8px;
    height: 24px;
    border: none;
    -webkit-appearance: none;
    appearance: none;
    background-repeat: no-repeat;
    padding: 9px;
  }
  .seek_slider:hover,
  .volume_slider:hover {
    opacity: 1.0;
  }
  .seek_slider {
    width: 100%;
    user-select: none;
  }
  .volume_slider {
    position: absolute;
    bottom: 70px;
    right: -51.5px;
    transform: rotateZ(270deg);
  }
  .current-time,
  .total-duration {
    padding: 5px;
  }
  .duration{
    margin: 10px;
    opacity: 0.7;
    border-radius: 40px;
  }
  i.fa-volume-down,
  i.fa-volume-up {
    margin-right: 94px;
    padding: 10px;
  }
  .floatdetails{
    display: flex;
    height: 30px;
    /* position: absolute; */
    color: rgb(0, 0, 0);
    margin: -8px;
    padding: 36px;
    border-radius: 26px;
    opacity: 0.9;
    padding-right: 21px;
    padding-left: 23px;
    /* text-align: center; */
    justify-content: center;
    align-items: center;
    align-content: center;
  }
  .wcontrol
  {
    display: flex;
    position: absolute;
    right: 0px;
    top: 13px;
    flex-direction: column;
    flex-wrap: nowrap;
    justify-content: space-between;
    height: 84px;
  }
  /* Close,maximize,minimize buttons container */
  .wcontrols{
    margin-top: 3.4px;
    right: 4px;
    display: block;
    position: absolute;
  }
    /* Close,maximize,minimize buttons */
  .wcontrols2{
    opacity: 0.5;
  }
  .wcontrols2:hover{
    opacity: 0.8;
  }
  /* Loaded video tracks list (Activated when moving cursor to right edge of the window) */
  .list2{
    position: absolute;
    width: 176px;
    height: 228px;
    background-color: rgb(228, 228, 228);
    opacity: 0.5;
    border: none;
    border-radius: 10px;
    overflow-y: auto;
    overflow-x: hidden;
    z-index: 222;
  }
  .list2poz1{
    top: 150px;
    right: 40px;
    width: 300px;
    height:450px;
  }
  .list2poz2{
    border-collapse: collapse;
    border-style: none;
    right: 13px;
    bottom: 46px;
  }
  .list2:hover{
    opacity: 1;
  }
  .list2 tr th td{
    color:white;
    background-color:rgb(231, 231, 231);
  }
  table {
    font-family: arial, sans-serif;
    border-collapse: collapse;
    width: 100%;
    position: absolute;
    height:auto;
  }
  td, th {
    text-align: left;
    padding: 8px;
  }
  tr:hover {
    background-color: rgb(48, 48, 48);
    color: white;
    user-select: none;
  }
  tr:active {
    background-color: rgb(170, 64, 64);
    color: white;
  }
  tr:nth-child(even):hover {
    background-color: rgb(48, 48, 48);
  }
  tr:nth-child(even):active {
    background-color: rgb(170, 64, 64);
  }
 /*  Menu button */
  .menu{
    position: absolute;
    right: 4px;
    bottom: 10px;
    opacity:0.5;
    z-index:1000;
  }
  /* Repeat button */
  .repeat{
    position: absolute;
    right: 34px;
    bottom: 10px; 
    z-index:1000;
  }
  #volume2{
    display: none;
    position: absolute;
    border: 1px solid #cfcfcf;
    background-color: rgb(239, 239, 239);
    width: 30px;
    height: 148px;
    bottom: 51px;
    bottom: 34px;
    right: 98px;
    border-radius: 50px;
    z-index: 202;
  }
  .infoplay
  {
    width: auto;
    display: flex;
    background-color: rgb(224 224 224 / 37%);
    margin-left: 10px;
    border-radius: 11px;
    margin-right: 10px;
    margin-top: 47px;
    justify-content: center;
  }
  .imagine {
    height: 90%;
    width: 98%;
    /* margin-left: 1%; */
    /* margin-right: 10%; */
    /* margin-right: 30px; */
    padding: auto;
    margin: auto;
    /* background-position: center; */
    /* background-repeat: no-repeat; */
    /* background-size: cover; */
    z-index: 1000;
    border-radius: 10px;
  }
  /* Dark/Light mode CSS */
  .darkMe{
    filter: invert(1);
  }
  /* Dark/Light mode CSS for text*/
  .darkMe2{
    color:#e7e7e7;                       
  }
  /* Dark/Light mode CSS for slider*/
  .darkMeSlider{
    accent-color: snow;
  }
 /*  Button CSS when toggled */
  .toggle{
    position: absolute;
    background-color: #d7d7d7;
    width: 30px;
    height: 30px;
    border-radius: 100%;
    z-index:1000;
  }
  /* Tabs for loaded images */
  #tabovi{
    display: flex;
    /* filter: grayscale(1); */
    margin-left: 18px;
    opacity: 0.3;
    transition: opacity 0.3s;
    z-index: 991;
  }
  #tabovi:hover{
    opacity:0.9;
  }
 /*  Tab close button */
  .tab-close{
    width: 12px;
    float: left;
    margin-top: 3px;
    height: 12px;
    background-color: #f54a4a;
    border-radius: 100%;
    margin-right: -9px;
    margin-left: 2px;
  }
  /* Top bar container for elements */
  .anal{
    display: flex;
    position: absolute;
    width: 100%;
    height: 30px;
    background-color: rgba(255, 255, 255, 0);
    align-items: flex-start;
    flex-direction: row;
    flex-wrap: nowrap;
    z-index: 1000;
    top: 0px;
  }
  /*  Tab CSS */
  .tab{
    color: rgb(206 206 206);
    background: #171717;
    /* border: 1px solid rgb(212, 212, 212); */
    width: 40px;
    /* height: 9px; */
    /* margin-inline: 2px; */
    margin-inline: -4px;
    margin-top: 6px;
    margin-left: -5px;
    /* margin-bottom: -28px; */
    border-radius: 6px;
    text-align: center;
    padding: 3.5px;
    user-select: none;
    overflow: hidden;
    transition: width 0.2s;
    border: #414141;
    border-style: solid;
    border-width: 0.1px;
  }
  .tab-active{
    width: 80px;
    transition: width 0.2s;
  }
  /* Container 1 for loaded image */
  .divslika{
    position: absolute;
    display: flex;
    height: auto;
    width: auto;
    bottom: 35px;
    top: 37px;
    margin: auto;
    z-index: 200;
    padding: auto;
    align-content: center;
    justify-content: center;
    align-items: center;
      flex-direction: row;
    flex-wrap: nowrap;
    overflow: hidden;
  }
/* Light/Dark mode button in picture view */
  .piclamp{
    position: absolute;
    left: 7px;
    bottom: 6px;
    opacity: 0.5;
    z-index: 1000;
  }
  /* Play/Pause button */
  #playpauseId{
    position: absolute;
    right: 16px;
    bottom: 67px;
    opacity: 0.6;
  }
  /* Overlay to hide volume slider, track list when mouse goes over it */
  .overley{
    display: none;
    width: 100%;
    height: 100%;
    position: fixed;
    /* z-index: 5555; */
    top: 0px;
    left: -150px;
    /* background-color: #bb3b3b86;  */    /* remove in dist */
  }
  /* Top bar photo, video, radio list, image buttons */
  .homeButtons{
    display: flex;
    background-color: #dddddd70;
    position: absolute;
    right: 0px;
    top: 0px;
    flex-direction: row;
    flex-wrap: nowrap;
    justify-content: space-between;
  }
  .homeButtons img{
    padding: 10px;
    opacity: 0.5;
  }
  .homeButtons img:hover{
    opacity: 1;
  }
  #titleBarId{
    display: block;
    position: absolute;
    width: 70%;
    height: 32px;
  }
  .hidden {
    opacity: 0;
    pointer-events: none; /* Ensure no interaction with hidden elements */
    transition: opacity 1s ease; 
  }
  .inputDialog{
    display: none;
    top: 40%;
    left: 35%;
    bottom: 40%;
    right: 35%;
    position: absolute;
    background-color: #cfcfcf;
    height: 150px;
    width: 200px;
    margin: auto;
    z-index: 1000;
    border-radius: 15px;
    flex-direction: column;
    flex-wrap: wrap;
    align-content: space-around;
    justify-content: center;
  }
  .buttonTime{
    height: 43px;
    width: 100%;
    margin: auto;
    shape-outside: margin-box;
    border: #37373700;
    padding: 8px;
    border-radius: 32px;
  }
  #meeting-time{
    margin: auto;
    border-radius: 55px;
    border: none;
    height: 50px;
    width: auto;
    padding: 20px
  }
  .hide-scrollbar {
  overflow: hidden;
  }
  .hide-scrollbar::-webkit-scrollbar {
  width: 0;
  height: 0;
  }
  .hide-scrollbar {
  scrollbar-width: none;
 }
  @keyframes fade-in {
    from {
      opacity: 0;
    }
    to {
      opacity: 1;
    }
  }

  @keyframes fade-out {
    from {
      opacity: 1;
    }
    to {
      opacity: 0;
    }
  }
  th{
    background: gainsboro;
  }
  .contextMenuVideo{
    display: none;
    position: absolute;
    width: 134px;
    height: 199px;
    background-color: rgb(228, 228, 228);
    opacity: 0.8;
    border: none;
    border-radius: 10px;
    overflow: hidden;
    z-index: 222;
    text-align: center;
  }
  .contextMenuVideo td{
    text-align: center;
  }
  #conversion{ 
    display:none;
    width: 50px;
    position: absolute;
    left: 18px;
    bottom: 53px;
    height: 10px;
    filter: hue-rotate(118deg);
    z-index: 999;
  }
  #zoomSliderId{
    position: absolute;
    right: 34px;
    padding: 0px;
    accent-color: currentcolor;
  }
  .messageDialog{
    display:none;
    background: #0404048f;
    position: absolute;
    top: 45%;
    padding-inline: 80px;
    height: 80px;
    width: auto;
    z-index: 10000;
    backdrop-filter: blur(10px);
    margin: auto;
  }
  #message{
    margin: 10px;
    text-align: center;
    font-size: 1em;
    border-radius: 10px;
    color: white;
  }
  .messageDialog input[type="button"]{
    height: 34px;
    width: 100px;
    border-radius: 10px;
    background: #afafaf33;
    border-style: none;
    color: white;
  }
  .messageDialog input[type="button"]:active{
    background: #9a9a9a;
  }
  #imageThumbnails{
    display: flex;
    position: absolute;
    width: 60%;
    height: 60px;
    background-color: #9393937a;
    border-radius: 20px;
    text-align: center;
    flex-wrap: nowrap;
    margin: auto;
    align-content: center;
    overflow-x: auto;
    z-index: 999999;
  }
  #imageThumbnails img{
    height: 50px;
    width: auto;
    margin: auto;
    margin-inline: 5px;
    z-index: 99999;
    /* transition: height 0.2s; */
  }
  #imageThumbnails img:hover{
   /*  height:80px;
    transition: height 0.2s; */
    border: #5ef59b;
    border-style: solid;
    border-radius: 5px;
  }
  .focus{
    opacity: 1;
    pointer-events: all;
    transition: opacity 1s ease; 
  }
  @media only screen and (max-width: 600px) {
    #zoomSliderId{
    display: none;
    transform: rotate(270deg) translate(80px, 60px);
  }
  #rotateButton{
    right:48px!important;
  }
  #zoomButton{
    display: block!important;
  }
  #tabovi{
    position: absolute;
    top: 33px;
    left: 0px;
  }
  .tabovi-active{
    display:block!important;
  }
  .tabovi-deActivate{
    display:none!important;
  }
  /* #tabsButton{
    display:block!important;
  } */
  /* Top bar element for window dragging */
  #titleBarId{
    width: 25%;
    left: 30px;
  }
  .seek_slider{
      position: absolute!important;
      bottom: 38px!important;
  }
  .slider_container{
    justify-content: space-between;
  }
  .current-time{
      position: absolute;
      left: 84px;
      bottom: 6px;
  }
  .total-duration{
      position: absolute;
      right: 143px;
      bottom: 6px;
  }
  .fa-volume-up
  {
    margin-bottom: 2px;
  }
  }
  @media only screen and (min-width: 600px){
  #zoomSliderId{
    display:block!important;
  }
 }
  @media only screen and (max-height: 650px){
  .list2poz1{
    height:50vh!important;
  }
  }
  .image-pane{
    max-width: 100%;
    max-height: 100%;
    background: black;
    align-content: center;
    width: 99%;
    height: 99%;
    text-align: center;
    z-index: 9999;
  }
  .image-pane img{
    max-width: 100%;
    max-height: 100vh;
    margin: auto;
    user-select: none;
    -webkit-user-drag: none;
  }
    .pane-close {
    position: absolute;
    top: 10px;
    right: 10px;
    width: 30px;
    height: 30px;
    background: rgba(255, 80, 80, 0.8);
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    z-index: 10;
    opacity: 0.7;
    transition: opacity 0.2s;
  }
  #thumbContainer{
    width: 100%;
    height: 100px;
    bottom: 20px;
    position: absolute;
    display: flex;
    justify-content: center;
  }

  
</style>
</head>
<body>
  <div class="divslika" id="elSlikaId" style="display:none;margin: auto;flex-wrap: nowrap;flex-direction: row;width: 100%;height: 100%;">
    <div class="image-pane" id="pane0">
      <img id="picka" style="max-width: 100%;
      max-height: 100vh;
      margin: auto;user-select: none;-webkit-user-drag: none;" src="media/123097127-selection-of-traditional-greek-food.jpg"></img>
    </div>
  </div>
  <div class="slider_container slider2" id="slikacontrol" style="background:rgb(238, 238, 238);display:none;">
    <div class="buttons">
      <!-- <div class="prev-track" style="position: absolute;right:34px;padding: 0px;" onclick="zoomIn()"><img src="set/zoom_in.png" class="lMode"  width="22px" height="auto"></div>
      <div class="next-track" style="position: absolute;right:1px;padding: 0px;" onclick="zoomOut()"><img src="set/zoom_out.png" class="lMode"  width="22px" height="auto"></div> -->
      <img class="piclamp lMode" onclick="darkmode()" src="set/lamp.png"  width="22px" height="auto">
      <div class="prev-track" onclick="prevTrack()"><img src="set/left.png" class="lMode" width="26px" height="auto"></div>
      <div class="next-track" onclick="nextTrack()"><img src="set/right.png" class="lMode" width="26px" height="auto"></div>
      <img id="addButton" class="lMode" onclick="splitView()" src="set/add.png" style="position: absolute;right: 186px;height: 18px;width: 18px;">
      <img id="rotateButton" class="lMode" onclick="rotatePicture()" src="set/repeat.png" style="position: absolute;right: 163px;height: 18px;width: 18px;">
      <img id="zoomButton" class="lMode" onclick="zoomOn();" src="set/zoom_in.png" style="display:none;position: absolute;right: 18px;height: 16px;width: 16px;">
      <input type="range" class="lMode" id="zoomSliderId" style="position: absolute;right:20px;padding: 0px;accent-color: currentcolor;" min="1" max="10" step="0.1" value="1"  onInput="zoomSlider()">
  </div>
  </div>
        <div id="thumbContainer">
        <div id="imageThumbnails" class="hide-scrollbar" onmouseover="this.classList.add('focus');" onmouseleave="this.classList.remove('focus');">
        </div>
       <!--  <img src="media/123097127-selection-of-traditional-greek-food.jpg"></img>
        <img src="media/123097127-selection-of-traditional-greek-food.jpg"></img> -->
      
      </div>
  <div class="inputDialog" id="unPauseAtTimeId">
    <input type="datetime-local" id="meeting-time" name="meeting-time" max="2039-08-08T00:00">
  <div style="margin: auto;height: auto;width: 85%;max-width: 188px;">
    <input class="buttonTime" id="buttonTimeId" type="button" value="Set" onclick="unPauseAtTimeEl.style.display='none';">
  </div>
  </div>
    <div class="messageDialog" id="messageDialogID">
      <div id="message">This is the message</div>
      <div style="text-align: center;">
        <input id="messageButtonId" type="button" value="Ok">
      </div>
    </div>
  <div class="anal" id="barId">
  <!-- <div class="wcontrols"> 
     <img class="wcontrols2 lMode" src="set/min.png" width="32px" height="auto">
     <img class="wcontrols2 lMode"src="set/max.png" width="32px" height="auto">
  <img class="wcontrols2 lMode"src="set/close.png" width="32px" height="auto">
</div> -->
<div class="tabovi-deActivate" style="display: none;" id="tabovi">
  <div class="tab">
    1
  </div>
  <div class="tab">
    2
  </div>
  <div class="tab">
    3
  </div>
  <div class="tab">
    4
  </div>
  <div class="tab">
    5
  </div>
  <div class="tab">
    6
  </div>
</div>
<img id="tabsButton" class="lMode" onclick="activateTabovi();" src="set/menu12.png" style="display:none;position: absolute;top: 11px;left:10px;height: 18px;width: 20px;opacity: 0.6;">
<div id="titleBarId"></div>
<div class="homeButtons" id="homeButtonsId">
  <img src="set/warning.png" class="lMode"  width="16px" height="auto"></td>
  <img src="set/settings.png" class="lMode" onClick="loadPicture()" width="16px" height="auto"></td>
  <img class="wcontrols2 lMode" src="set/min.png" onclick="win.minimize()" width="16px" height="auto">
  <img class="wcontrols2 lMode"src="set/max.png" onclick="WindowMinMax()" width="16px" height="auto">
  <img class="wcontrols2 lMode"src="set/close.png" onclick="win.close()"  width="16px" height="auto">
</div>
</div>
<div class="infoplay" id="infoId"><div class="floatdetails" id="floatdetailsId"><div class="track-name" style="opacity:1;">Track Name</div> &nbsp&nbsp<span style="font-size: 1.3rem;padding-bottom: 4px;">-</span>&nbsp&nbsp<div class="track-artist" style="opacity:1;">Track Artist</div></div>
          </div>
    <div class="player" id="playerId">
        <div class="details" id="videoD" style="display:none;overflow: hidden;">                                    
            <video type="video/mp4" style="width: 100%; height: 100%;background-color: black;"id="audiodd" width="98.3%" onclick="playpauseTrack()">
            </video>
            <!-- <img class="lMode" id="playpauseId" src="set/pause2.png"  width="54px" height="auto"> -->   
        </div>
        <progress id="conversion" value="0" max="100" style="width: 50px;"></progress>
        <div class="slider_container" id="slider_container_Id">
          <div class="buttons">
            <div class="prev-track" onclick="prevTrack()"><img src="set/up.png" class="lMode" width="22px" height="auto"></div>
            <div class="next-track" onclick="nextTrack()"><img src="set/down.png" class="lMode" width="22px" height="auto"></div>
            <div class="playpause-track" onclick="playpauseTrack()"><img id="playpause" src="set/play.png" class="lMode" width="20px" height="auto"></div>
            <div class="toggle" id="repeatId" style="right: 30px; bottom: 6px;display:none;"></div>
            <img class="repeat lMode"  onclick="repeat();closeall()" src="set/repeat.png"  width="22px" height="auto">
            <img class="menu lMode" onclick="openMenu();" src="set/menu12.png"  width="22px" height="auto">
        </div>
          <div class="duration" id="durationCId"><span class="current-time">00:00</span></div>  <input type="range" min="1" max="500" value="0" id="seeksliderId" class="seek_slider" onInput="seekTo()"><div class="duration" id="durationEId"><span class="total-duration">00:00</span></div> 
          <div class="yes">
            <div class="overley" id="overleyId" onmouseover="overleymentFunction(overleyment)"></div>
            <i class="fa fa-volume-up lMode" onmouseOver="volumeH()" onClick="volumeC()"></i>
            <div style="display:none;" id="volume2"><input type="range" min="1" max="100" value="99" class="volume_slider" id="volumesliderId" onchange="setVolume()"></div>
          </div>
        </div> 
    </div>
    <div id="overleyId" onmouseover="overleymentFunction(overleyment)"></div>
    <div class="list2 list2poz2" id="menuId" onclick="closeall()" style="display: none;">
      <table>
        <tr>
          <td>  <img src="set/add.png" class="lMode" width="18px" height="auto"></td>
          <td><label>
            Open file
            <input type="file" style="position: fixed; top: -100%">
          </label></td>
        </tr>
        <tr>
          <td> <img src="set/folder.png" class="lMode" width="18px" height="auto"></td>
          <td><label>
            Use folder
            <input type="file" style="position: fixed; top: -100%" webkitdirectory directory multiple>
          </label></td>
        </tr>
        <tr onclick="darkmode()">
          <td>  <img src="set/lamp.png" class="lMode" width="18px" height="auto"></td>
          <td>Light/Dark mode</td>
        </tr>
        <tr onClick="unPauseTimeF()">
          <td>  <img src="set/clock.png" class="lMode" width="18px" height="auto"></td>
          <td>Unpause at time</td>
        </tr>
        <tr onclick="updateApp();">
          <td>  <img src="set/system-update.png" class="lMode" width="18px" height="auto"></td>
          <td>Update</td>
        </tr>
        <tr>
          <td>  <img src="set/settings.png" onclick="win.showDevTools();" class="lMode" width="18px" height="auto"></td>
          <td>Settings</td>
        </tr>
      </table>
    </div>
    <div class="contextMenuVideo" id="contextMenuVideoId">
    <table>
    <tr onclick="convertDialog.style.display='flex';"><td>Convert</td></tr>
    <tr onclick=""><td>Load all media from folder</td></tr>
    <tr><td>Delete</td></tr>
    </table>
    </div>
    <div class="inputDialog" id="convertId">
      <label for="select-format" style="padding-bottom: 2px;">Convert to:</label>
      <select id="select-format" style="width:150px;height:40px;margin-bottom: 10px;border-radius: 5px;">
        <option value="mp4">Jpeg</option>
        <option value="avi">PNG</option>
        <option value="mov">BMP</option>
      </select>
      <input type="button" value="Convert" style="height: 40px;border-radius: 10px;" onclick="convertDialog.style.display='none';document.getElementById('select-format').value)">
      </div>
    </div>
    <div id="drop_zone" ondrop="dropHandler(event);" ondragover="dragOverHandler(event);" style="display:none;background:rgba(158, 20, 20, 0.582);width:100%;height:100%;position: absolute;z-index:9000;left:0px;top:0px">
</div>
    <!-- Main script for the player -->
    <script>
      document.addEventListener("keydown", (event) => {
     if(event.code=='Space'){
      playpauseTrack();
     }
     if(event.code=='ArrowLeft'){
      curr_track.pause();
      curr_track.currentTime-=0.8;
     }
     if(event.code=='ArrowRight'){
      curr_track.pause();
      curr_track.currentTime+=0.8;
     }
     if(event.code=='ArrowUp'){
      volume_slider.value+=10; // I don't get it
      setVolume();
      console.log(volume_slider.value);
     }
     if(event.code=='ArrowDown'){
      volume_slider.value-=10;
      setVolume();
      console.log(volume_slider.value);
     }
     if(event.code=='Numpad8'){
     nextTrack(); 
     }
     if(event.code=='Numpad2'){
     prevTrack();
     }
     if(event.code=='KeyF'){
      WindowMinMax();
     }
     console.log(event);
     
  });
  document.addEventListener("keyup", (event) => {
     if(event.code=='ArrowLeft'){
        if(elSlikaEl.style.display!='flex'){
          curr_track.currentTime-=10;
          curr_track.play();
         }
        else{
          prevTrack();
        }
     }
     if(event.code=='ArrowRight'){
      if(elSlikaEl.style.display!='flex'){
        curr_track.currentTime+=10;
        curr_track.play();
     }
     else{
        nextTrack();
    }
    }
      
  });
  console.log("errorrrrrrrrrrrrrr 1");
   document.addEventListener('dragover', function () {
      document.getElementById("drop_zone").style.display="block";
    });
function dropHandler(ev) {
  console.log("File(s) dropped");
  // Prevent default behavior (Prevent file from being opened)
  ev.preventDefault();
  if (ev.dataTransfer.items) {
    // Use DataTransferItemList interface to access the file(s)
    [...ev.dataTransfer.items].forEach((item, i) => {
      // If dropped items aren't files, reject them
      if (item.kind === "file") {
        const file = item.getAsFile();
        console.log(file);
        console.log(`… file[${i}].name = ${file.path}`);
        let splitArg=file.path.split("\\");
        let nameLen=splitArg.length-1;
        let nameArg=splitArg[nameLen];
        let photoFPath = file.path.substring(0, file.path.length-nameArg.length);
        //readPhotosInFolder(photoFPath);
        console.log(nameArg);
        let theFile=newFileObj(nameArg,file.path,file.type);
        console.log(theFile);
      /*   if(!listOfPaths.includes(theFile.path)){ // To avoid double items in list
          listOfPaths.push(theFile.path);
          track_list.push(theFile);
        } */
        let found_file=0;
        track_list.forEach(function(element,index) {
          if (theFile.path==element.path){
            if(theFile.type.includes('image')){
            loadPicture();
            }
            else{
            found_file=1;
            track_index=index;
          }
          }
       });
       if(found_file==0){
       console.log("push non repeated file");
       if(theFile.type.includes('image') || theFile.type.includes('video')){
        track_list.push(theFile);
       }
       track_index=track_list.length-1;
      } 
      }
    });
  } else {
    // Use DataTransfer interface to access the file(s)
    [...ev.dataTransfer.files].forEach((file, i) => {
      console.log(`… file[${i}].name = ${file.path}`);
    });
  }
  document.getElementById("drop_zone").style.display="none";
  let last_track=track_list[track_index];
  console.log(last_track);
  loadThumbnails();
if(last_track.type.includes('video')){
  openVideo();
}
if(last_track.type.includes('image')){
  pickaEl.src=last_track.path;
  loadPicture();
}
  loadTrack(track_index);
  playTrack();
}
console.log("errorrrrrrrrrrrrrr 2");
function dragOverHandler(ev) {
  console.log("File(s) in drop zone");
  // Prevent default behavior (Prevent file from being opened)
  ev.preventDefault();
}
console.log("errorrrrrrrrrrrrrr 2");
var win = nw.Window.get();
win.resizeTo(1200,720);
win.setPosition("center");
//win.showDevTools();

let now_playing = document.querySelector(".now-playing");
let track_name = document.querySelector(".track-name");
let contextMenuVideo=document.getElementById("contextMenuVideoId");
let playpause = document.getElementById("playpause");
let unPauseAtTimeEl = document.getElementById("unPauseAtTimeId");
let next_btn = document.querySelector(".next-track");
let prev_btn = document.querySelector(".prev-track");
let convertDialog=document.getElementById('convertId');
let seek_slider = document.getElementById("seeksliderId");
let volume_slider = document.querySelector(".volume_slider");
let playerGEl=document.getElementById("playerId");
let curr_time = document.querySelector(".current-time");
let total_duration = document.querySelector(".total-duration");
let menuE=document.getElementById('menuId');
let track_index = 0;
let repeatN=0;
let shufferN=0;
let isPlaying = false;
let updateTimer;
let repeatEl=document.getElementById('repeatId');
let slikaControlEl=document.getElementById('slikacontrol');
let volumeb=document.getElementById('volume2');
let infoEl=document.getElementById('infoId');
let imageThumbnails=document.getElementById('imageThumbnails');  
let seeksliderEl=document.getElementById('seeksliderId');
let volumeEl=document.getElementById('volumesliderId');
// Create new audio element
let curr_track = document.getElementById('audiodd');
let tabelaG=document.getElementById('tabelaId');
let pickaEl=document.getElementById('picka');
// Define the tracks that have to be played
var overleyment = document.getElementById('overleyId');
let playerEl=document.getElementById('audiodd');
let videoEl=document.getElementById('videoD');
let elSlikaEl=document.getElementById("elSlikaId");
let tabsBar=document.getElementById('tabovi');
let tabsEl=tabsBar.getElementsByClassName("tab");
var videoWasOpened=0,cImageRotation=0,seekEndDuration=0,seekStartDuration=0,VideoErr=0,prevThumbnail=0;
let paneCount=1,activePaneId=1,scaleValue=1;
const fs = require ('fs');
let listOfPaths=[];
const fileObj={
    name: "Object",
    artist: "Object",
    image: "set/default.webp",
    path: "",
    duration: "",
    type:"",
}
console.log("errorrrrrrrrrrrrrr 3");
// Define desired object
function newFileObj(name,path,type){
  return {"name": name, "artist": "","image":"set/default.webp","path":"file://"+path,"duration":"","type":type};
}
function newTabObj(name,path,type){
  return {"name": name, "path": path,"index":index};
}
let video_list=[]; //For future use
let track_list = [
  {
    name: "Test",
    artist: "Test",
    image: "set/default.webp",
    path: "media/123097127-selection-of-traditional-greek-food.jpg",
    duration:"",
    type:"image",
  }
]; 
let tab_list = [
  {
    name: "",
    path: "",
    index: "",
  },
  {
    name: "",
    path: "",
    index: "",
  }
];  
console.log("errorrrrrrrrrrrrrr 4");
var isMax=0;
function WindowMinMax(){
  if(isMax==1){
    if(win.isKioskMode==true){
      win.leaveKioskMode();
      isMax=0;
    }
    else{
    win.unmaximize();
    isMax=0;
    }
  }
  else{
    if(videoEl.style.display=="block"){
      win.enterKioskMode();
      isMax=1;
    }
    else{
    win.maximize();
    isMax=1;
    }
  }
}
console.log("errorrrrrrrrrrrrrr 5");
console.log("errorrrrrrrrrrrrrr 6");
function clearList(){

  tabelaG.innerHTML="";

}
function volumeH(){
  overleyment.style.display="block";
volumeb.style.animation="fade-in 0.4s"
volumeb.style.display='block';
} 
function volumeC(){
switch(volumeb.style.display) {
case 'none':
overleyment.style.display="block";
volumeb.style.animation="fade-in 0.4s"
volumeb.style.display='block';
  break;
case 'block':
overleyment.style.display="none";
volumeb.style.animation="fade-out 0.4s"

  break;
} 
}
console.log("errorrrrrrrrrrrrrr 7");
function openMenu(){
  overleyment.style.display="block";
switch(menuE.style.display) {
case 'none':
menuE.style.display='block';
menuE.style.animation="fade-in 0.4s";
  break;
case 'block':
menuE.style.animation="fade-out 0.4s";
  break;

} }
function getRandomInt(max) {
return Math.floor(Math.random() * max);
}

function zoomIn(){
elSlikaEl.style.display="flex";
scaleValue=scaleValue+0.5;
pickaEl.style.transform="scale("+scaleValue+")";
}
let zoomV=1;
function zoomInDown(){

while(zoomV==1){
setTimeout(function(){
scaleValue=scaleValue+1;
pickaEl.style.transform="scale("+scaleValue+")";

}, 500); 

}}
function zoomInUp(){
zoomV=0;
}
function zoomOut(){
if(scaleValue!=1){
if (scaleValue==2){
elSlikaEl.style.display="flex";
}
scaleValue=scaleValue-0.5;
pickaEl.style.transform="scale("+scaleValue+")";
}
}

console.log("errorrrrrrrrrrrrrr 8");
function repeat(){
switch(repeatEl.style.display) {
case 'none':
repeatEl.style.display='block';
console.log("repeat on");
curr_track.removeEventListener("ended", nextTrack);
curr_track.addEventListener("ended", playTrack);
  break;
case 'block':
repeatEl.style.display='none';
console.log("repeat off");
curr_track.removeEventListener("ended", playTrack);
curr_track.addEventListener("ended", nextTrack);
  break;
} 

}
function darkmode(){
  var imgs = document.getElementsByClassName("lMode");
  
  var elements = document.querySelectorAll("div.list>tr:nth-child(even)");
  switch(document.body.style.backgroundColor) {
  
    case 'white':
document.getElementById('floatdetailsId').style.color="white";
document.body.style.backgroundColor = "black";
// document.getElementById('barId').style.backgroundColor="black";
document.getElementById('slider_container_Id').style.background="#08080870";
document.getElementById('homeButtonsId').style.background="#08080870";
document.getElementById('slikacontrol').style.background="#08080870";
volumeb.style.background="#08080870";
document.getElementById('durationCId').style.color="white";
document.getElementById('durationEId').style.color="white";
menuE.style.color="white";
menuE.style.background="#2c2c2c";
for (let item of imgs) {
    item.classList.add("darkMe");
    }
  seeksliderEl.classList.add('darkMeSlider');
  volumeEl.classList.add('darkMeSlider');
 infoEl.classList.add("darkMe2");
 tabsBar.classList.remove("darkMe");
for (i = 0; i < elements.length; i++) {
elements[i].style.background = "#838383";  
}
  break;
  
  
case 'black':
document.getElementById('floatdetailsId').style.color="black";
// document.getElementById('barId').style.backgroundColor="white";
document.getElementById('slider_container_Id').style.background="#dddddd70";
document.getElementById('homeButtonsId').style.background="#dddddd70";
document.getElementById('slikacontrol').style.background="#dddddd70";
volumeb.style.background="#dddddd70";
document.getElementById('durationCId').style.color="black";
document.getElementById('durationEId').style.color="black";
document.body.style.backgroundColor = "white";
menuE.style.color="black";
menuE.style.background="rgb(228, 228, 228)";

for (let item of imgs) {
    item.classList.remove("darkMe");
    }
    seeksliderEl.classList.remove('darkMeSlider');
  volumeEl.classList.remove('darkMeSlider');
 infoEl.classList.remove("darkMe2");
 tabsBar.classList.add("darkMe");
  break;
  default:
  document.getElementById('floatdetailsId').style.color="white";
document.body.style.backgroundColor = "black";
// document.getElementById('barId').style.backgroundColor="black";
document.getElementById('slider_container_Id').style.background="#08080870";
document.getElementById('homeButtonsId').style.background="#08080870";
document.getElementById('slikacontrol').style.background="#08080870";
volumeb.style.background="#08080870";
document.getElementById('durationCId').style.color="white";
document.getElementById('durationEId').style.color="white";
menuE.style.color="white";
menuE.style.background="#2c2c2c";
for (let item of imgs) {
    item.classList.add("darkMe");
    }
  seeksliderEl.classList.add('darkMeSlider');
  volumeEl.classList.add('darkMeSlider');
 infoEl.classList.add("darkMe2");
 tabsBar.classList.remove("darkMe");

for (i = 0; i < elements.length; i++) {
elements[i].style.background = "#838383";  
}

} 
}
const dateNow = new Date();
let dateNowFormated= new Date().toISOString().slice(0, -8);
document.getElementById("meeting-time").value=dateNowFormated;
document.getElementById("meeting-time").min=dateNowFormated;
console.log(dateNowFormated);
// Generate thumbnail for image
async function generateThumbnail(fileObj) {
    try {
        const thumbnailPath = path.join(os.tmpdir(), `thumb_${Date.now()}.jpg`);
        
        await sharp(fileObj.realPath)
            .resize(200, 200, {
                fit: 'inside',
                withoutEnlargement: true
            })
            .jpeg({ quality: 80 })
            .toFile(thumbnailPath);
        
        fileObj.thumbnail = thumbnailPath;
        updateThumbnailContainer();
    } catch (err) {
        console.error('Error generating thumbnail:', err);
        fileObj.thumbnail = fileObj.path; // Fallback to original
        updateThumbnailContainer();
    }
}
// Load cached thumbnails from ~/.cache/thumbnails
async function loadCachedThumbnails() {
    const thumbnailDir = path.join(os.homedir(), '.cache', 'thumbnails', 'normal');
    
    if (!fs.existsSync(thumbnailDir)) {
        return;
    }
    
    try {
        const files = fs.readdirSync(thumbnailDir);
        console.log(`Found ${files.length} cached thumbnails`);
    } catch (err) {
        console.error('Error loading cached thumbnails:', err);
    }
}
function loadThumbnails(){
   imageThumbnails.innerHTML="";
    track_list.forEach(function(pictureThumb,index){
      imageThumbnails.innerHTML+="<img src='"+pictureThumb.path+"' id=F"+index+" onclick='openPhoto("+index+");moveThumbnail("+index+");'></img>"
     })
}
function loadPicture(){
     playerGEl.style.display="none";
     infoEl.style.display="none";
     slikaControlEl.style.display="block";
     elSlikaEl.style.display="flex";

    //  document.getElementById("slikatest").style.display="block";
    //  document.getElementById("picka").src="";
     document.getElementById("tabovi").style.display="flex";
  
   }
   console.log("errorrrrrrrrrrrrrr 9");
let error_track_src="";
function loadTrack(index) {
  track_index=index;
  clearInterval(updateTimer);
  resetValues();
  if (track_list[track_index].type.includes("video")){
    openVideo();
    videoEl.style.display="block";
  }
  else if (track_list[track_index].type.includes('image')){
    videoEl.style.display="none";
    document.getElementById(activePaneId).children[0].src=track_list[track_index].path;
    loadPicture();
  }
  // Load a new track
  curr_track.src = track_list[track_index].path;
  curr_track.load();
  // Update details of the track
  track_name.textContent = track_list[track_index].name;
  document.title = track_list[track_index].artist+' - '+track_list[track_index].name;
  //now_playing.textContent = "PLAYING " + (track_index + 1) + " OF " + track_list.length;
  // Set an interval of 1000 milliseconds for updating the seek slider
  updateTimer = setInterval(seekUpdate, 1000);
  // Move to the next track if the current one finishes playing
}
curr_track.addEventListener('error', function() {
      console.log("Video error");
      console.log(event);
      if(isNaN(curr_track.duration) && track_list[track_index].path.includes(".mp4") && VideoErr==0 && curr_track.src!=error_track_src){
          error_track_src=curr_track.src;
          VideoErr=1;
          alert("Video is broken");
        } 
      },false);
  curr_track.addEventListener('loadeddata', function() {
  console.log("Video loaded");
  VideoErr=0;
  }, false);
  console.log("errorrrrrrrrrrrrrr 10");
let pos = { top: 0, left: 0, x: 0, y: 0 };
const ele = document.getElementById('picka');

const mouseDownHandler = function (e) {
pos = {
    // The current scroll
    left: ele.scrollLeft,
    top: ele.scrollTop,
    // Get the current mouse position
    x: e.clientX,
    y: e.clientY,
};

document.addEventListener('mousemove', mouseMoveHandler);
document.addEventListener('mouseup', mouseUpHandler);
};

const mouseMoveHandler = function (e) {
// How far the mouse has been moved
const dx = e.clientX - pos.x;
const dy = e.clientY - pos.y;

// Scroll the element
ele.scrollTop = pos.top - dy;
ele.scrollLeft = pos.left - dx;
};


const mouseUpHandler = function () {
document.removeEventListener('mousemove', mouseMoveHandler);
document.removeEventListener('mouseup', mouseUpHandler);
ele.style.cursor = 'grab';
};
console.log("errorrrrrrrrrrrrrr 11");
function openVideo(){
console.log("openVideo");
if (track_list[track_index].type.includes("video")){
    videoEl.style.display="block";
  }
slikaControlEl.style.display="none";
playerGEl.style.display="block";
infoEl.style.display="flex";
    slikaControlEl.style.display="none";
     document.getElementById("elSlikaId").style.display="none";
    //  document.getElementById("slikatest").style.display="block";
    //  document.getElementById("picka").src="";
     document.getElementById("tabovi").style.display="none";
}
// Reset Values
function resetValues() {
  curr_time.textContent = "00:00";
  total_duration.textContent = "00:00";
  seek_slider.value = 0;
}

function playpauseTrack() {
  if (!isPlaying) playTrack();
  else pauseTrack();
}

function playTrack() {
  curr_track.play();
  isPlaying = true;

  // Replace icon with the pause icon
  playpause.src = "set/pause.png";
}
console.log("errorrrrrrrrrrrrrr 12");
function pauseTrack() {
  curr_track.pause();
  isPlaying = false;

  // Replace icon with the play icon
  playpause.src = "set/play.png";
}

function nextTrack() {
  if (track_index < track_list.length - 1)
    track_index += 1;
  else track_index = 0;
  loadTrack(track_index);
  playTrack();
}

function prevTrack() {
  if (track_index > 0)
    track_index -= 1;
  else track_index = track_list.length;
  loadTrack(track_index);
  playTrack();
}
function openPhoto(index){
   document.getElementById(activePaneId).children[0].src=track_list[index].path;
}
function moveThumbnail(index){

}
/* function scrollByElements(elementCount) {
  const elementWidth = imageThumbnails.scrollWidth / imageThumbnails.children.length;
  imageThumbnails.scrollLeft += elementWidth * elementCount;
} */

function padZero(number) {
  return number < 10 ? '0' + number : number;
}
function seekTo() {
  seekto = curr_track.duration * (seek_slider.value / 500);
  curr_track.currentTime = seekto;
}

function setVolume() {
  curr_track.volume = volume_slider.value / 100;
}
console.log("errorrrrrrrrrrrrrr 13");
function seekUpdate() {
  let seekPosition = 0;

  // Check if the current track duration is a legible number
  if (!isNaN(curr_track.duration)) {
    seekPosition = curr_track.currentTime * (500 / curr_track.duration);
    seek_slider.value = seekPosition;

    // Calculate the time left and the total duration
    let currentMinutes = Math.floor(curr_track.currentTime / 60);
    let currentSeconds = Math.floor(curr_track.currentTime - currentMinutes * 60);
    let durationMinutes = Math.floor(curr_track.duration / 60);
    let durationSeconds = Math.floor(curr_track.duration - durationMinutes * 60);

    // Adding a zero to the single digit time values
    if (currentSeconds < 10) { currentSeconds = "0" + currentSeconds; }
    if (durationSeconds < 10) { durationSeconds = "0" + durationSeconds; }
    if (currentMinutes < 10) { currentMinutes = "0" + currentMinutes; }
    if (durationMinutes < 10) { durationMinutes = "0" + durationMinutes; }

    curr_time.textContent = currentMinutes + ":" + currentSeconds;
    total_duration.textContent = durationMinutes + ":" + durationSeconds;
  }
}

// Load the first track in the tracklist
//loadTrack(track_index);
function random_color_tabs() {
let red = Math.floor(Math.random() * 55) + 200;
let green = Math.floor(Math.random() * 55) + 200;
let blue = Math.floor(Math.random() * 55) + 200;
console.log(Math.floor(Math.random() * 55));
console.log(Math.floor(Math.random() * 55));
console.log(Math.floor(Math.random() * 55));
let bgColor = "rgb(" + red + "," + green + "," + blue + ")";
for (let item of tabsEl) {
  let red = Math.floor(Math.random() * 55) + 200;
let green = Math.floor(Math.random() * 55) + 200;
let blue = Math.floor(Math.random() * 55) + 200;
let bgColor = "rgb(" + red + "," + green + "," + blue + ")";
  
  item.style.backgroundColor = bgColor;
    }
}


function overleymentFunction (pelement) {
  overleyment.style.display="none";
  const eleArray=[volumeb,menuE];
  overleyment.style.display="none";
  eleArray.forEach((element) => {if(element!=pelement){element.style.animation="fade-out 0.4s"}});

}
console.log("errorrrrrrrrrrrrrr 14");
function closeall(){
  overleyment.style.display="none";
  if(volumeb.style.display=='block'){
  volumeb.style.animation="fade-out 0.4s";
  }
  if(menuE.style.display=='block'){
  menuE.style.animation="fade-out 0.4s";
}
}

function unPauseTimeF(){
  unPauseAtTimeEl.style.display="flex";
}
var toggleTabs=0;
function activateTabovi(){
  if(toggleTabs==0){
  tabsBar.classList.remove("tabovi-deActivate");
  tabsBar.classList.add("tabovi-active");
  toggleTabs=1;
 }
 else if(toggleTabs==1){
  tabsBar.classList.add("tabovi-deActivate");
  tabsBar.classList.remove("tabovi-active");
  toggleTabs=0;
}
}
var zoomOnV=0;
function zoomOn(){
  if(zoomOnV==0){
  document.getElementById("zoomSliderId").style.display='block';
  zoomOnV=1;
 }
 else if(zoomOnV==1){
  document.getElementById("zoomSliderId").style.display='none';
  zoomOnV=0;
}
  
}
for (var i = 0; i < tabsEl.length; i++) {
  tabsEl[i].addEventListener("click", function() {
    var current = document.getElementsByClassName("tab-active");
    // If there's no active class
    if (current.length > 0) {
      current[0].removeChild(current[0].firstElementChild);
      current[0].className = current[0].className.replace(" tab-active", "");
    }
    // Add the active class to the current/clicked button
    this.className += " tab-active";
    current[0].innerHTML+="<span class='tab-close'>";
  });
}
console.log("errorrrrrrrrrrrrrr 15");
/* random_color_tabs(); */
document.addEventListener('animationstart', function (e) {
if (e.animationName === 'fade-in') {
e.target.classList.add('did-fade-in');
}
});

document.addEventListener('animationend', function (e) {
if (e.animationName === 'fade-out') {
volumeb.style.display="none";
menuE.style.display="none";
}
});
console.log("errorrrrrrrrrrrrrr 16");
videoEl.addEventListener('dblclick', function (e) {
  if(win.isKioskMode==false){
    win.enterKioskMode();
    isMax=1;
  }
  else if(win.isKioskMode==true){
    win.leaveKioskMode();
    isMax=0;
  }
});
function trackMousePosition() {
    let titleBar=document.getElementById('titleBarId');
    let isMouseDownTitleBar = false;
    let isMouseDownPicture = false;
    let cX=0;
    let cY=0;
    // Create a function to handle mouse movement
    function handleMouseMove(event) {
      if (isMouseDownTitleBar && isMax!=1) {
        const xM = event.screenX-cX;
        const yM = event.screenY-cY;
        win.moveTo(xM, yM);
        // Do something with the x and y positions here
      }
      if (isMouseDownPicture){
        const xM = event.screenX-cX;
        const yM = event.screenY-cY;
        elSlikaEl.scrollBy(-xM, -yM);
        cX=event.screenX;
        cY=event.screenY;
      }
    }

    // Add event listeners for mouse down and up
    titleBar.addEventListener('mousedown', function () {
      cX=event.clientX+5;
      cY=event.clientY+30;
      isMouseDownTitleBar = true;
    });
    elSlikaEl.addEventListener('mousedown', function () {
      cX=event.clientX+169;
      cY=event.clientY+60;
      isMouseDownPicture = true;
    });
    document.addEventListener('mouseup', function () {
      isMouseDownTitleBar = false;
      isMouseDownPicture = false;
    });
    console.log("errorrrrrrrrrrrrrr 17");
    // Add event listener for mouse move
    document.addEventListener('mousemove', handleMouseMove);
  }
 
  // Call the function to start tracking mouse position
  trackMousePosition();
  darkmode();
 
  let pathElm=nw.App.argv;
  win.focus();
  //track_name.innerHTML=nw.App.argv;
  //fileObj.name="the File";
  if(pathElm){
  (pathElm).forEach(function(pathArg,index) {
  let splitArg=pathArg.split("\\");
  let nameLen=splitArg.length-1;
  let nameArg=splitArg[nameLen];
  let theFile;
  if(pathArg.includes('.mp4') || pathArg.includes('.avi')){
    theFile=newFileObj(nameArg,pathArg,'video');
    track_list.push(theFile);
    //video_list.push(theFile);
    console.log("pathElm lenght is:"+pathArg.length+"index is: "+index);
    if(pathElm.length-1==index){
    track_index=track_list.length-1;
    openVideo();
    loadTrack(track_index);
    playTrack();
  }
  }
  if(pathArg.includes('.jpg') || pathArg.includes('.jpeg') || pathArg.includes('.gif') || pathArg.includes('.avif') || pathArg.includes('.png') || pathArg.includes('.svg') || pathArg.includes('.webp')){
    theFile=newFileObj(nameArg,pathArg,'image');
    track_list.push(theFile);
    //track_list.push(theFile);
    if(pathElm.length-1==index){
    trackIndex=track_list.length-1;
    pickaEl.src=track_list[trackIndex].path;
    let photoFPath = track_list[trackIndex].path.substring(0, track_list[trackIndex].path.length-nameArg.length);
    //readPhotosInFolder(photoFPath);
    imageThumbnails.innerHTML+="<img src='"+pictureThumb.path+"' id=F"+index+" onclick='openPhoto("+index+");moveThumbnail("+index+");'></img>"
    loadPicture();
    }
  }
});
  }
  
  console.log("yes");
  nw.App.on('open', (args)=>{
  win.focus();
  let textArg=args.toString();
  console.log("textArg "+textArg);
  let pathArg=textArg.split('"')[5];
  let splitArg=pathArg.split("\\");
  console.log("splitArg "+splitArg);
  let nameLen=splitArg.length-1;
  let nameArg=splitArg[nameLen];
  let theFile;
  if(pathArg.includes('.mp4') || pathArg.includes('.avi')){
    theFile=newFileObj(nameArg,pathArg,'video');
  }
  if(pathArg.includes('.jpg') || pathArg.includes('.jpeg') || pathArg.includes('.gif') || pathArg.includes('.avif') ||  pathArg.includes('.png') || pathArg.includes('.svg') || pathArg.includes('.webp')){
    theFile=newFileObj(nameArg,pathArg,'image');
    track_list.push(theFile);
  }
  console.log("App opened via file" + args);
      let found_file=0;
        track_list.forEach(function(element,index) {
          if (theFile.path==element.path){
            found_file=1;
            track_index=index;
          }
       });
       if(found_file==0){
       console.log("Push non repeated file");
       track_list.push(theFile);
       track_index=track_list.length-1;
      }
      if(track_list[track_index].type.includes('video')){
        openVideo();
        loadTrack(track_index);
        playTrack(); 
      }
      if(track_list[track_index].type.includes('image')){
        pickaEl.src=track_list[track_index].path;
        let photoFPath = track_list[track_index].path.substring(0, track_list[track_index].path.length-nameArg.length);
        //readPhotosInFolder(photoFPath);
        loadPicture();
        imageThumbnails.innerHTML+="<img src='"+pictureThumb.path+"' id=F"+index+" onclick='openPhoto("+index+");moveThumbnail("+index+");'></img>"
      }
            
  /* loadOpenedStuff(); */
});
function loadOpenedStuff(){
  //to do
}
  //background: linear-gradient(to right, rgb(198, 198, 198) 0%, rgb(198, 198, 198) 16%, rgb(37, 218, 165) 16%, rgb(37, 218, 165) 89%, rgb(198, 198, 198) 89%, rgb(198, 198, 198) 100%);
  window.onresize = reSize;
  function reSize(){
    let widthSeek=seeksliderEl.offsetWidth+"px";
  }
  reSize();
  //Open file with app END
//Context menu
console.log("errorrrrrrrrrrrrrr 19");
if (document.addEventListener) {
  videoEl.addEventListener('contextmenu', function(e) {
    contextMenuVideo.style.display="block";
    contextMenuVideo.style.left=e.clientX+"px";
    contextMenuVideo.style.top=e.clientY+"px";
    e.preventDefault();
  }, false);
} else {
  videoEl.attachEvent('oncontextmenu', function() {
    alert("You've tried to open context menu");
    window.event.returnValue = false;
  });
}
document.addEventListener('click', function(e) {
    contextMenuVideo.style.display="none";
  }, false);
//Context menu END
async function updateApp() {
  fs.copyFile('index.html', 'index_backup.html', (err) => {
  if (err) {
    console.error('Error copying file:', err);
  } else {
    console.log('File copied successfully!');
  }
  });
  const response = await fetch("https://github.com/banekondic1996/Melo/blob/development/src/index.html");
  const jsonResponse = await response.json();
  let text = jsonResponse.payload.blob.rawLines
  let textFinal="";
  text.forEach (t => {
  textFinal=textFinal+t;
}) 
  fs.writeFileSync('update_test.html',textFinal) //change for distribution
  console.log(text);
  alert("Update complete. Restart the app to see changes");
  
}
console.log("errorrrrrrrrrrrrrr 20");
console.log("errorrrrrrrrrrrrrr 21");
//win.showDevTools(); //debuging only, will crash nw.js non sdk version, you have to download nw.js sdk package
console.log("errorrrrrrrrrrrrrr 22");
const inactivityTimeout = 700; 
let timeoutId;
function hideElementsAndCursor() {
    if(isMax==1){
    document.getElementById('slider_container_Id').classList.add('hidden');
    document.getElementById('homeButtonsId').classList.add('hidden');
    curr_track.style.cursor = 'none';
    imageThumbnails.classList.add('hidden');
  }
  else{
    curr_track.style.cursor = 'none';
    imageThumbnails.classList.add('hidden');
  }
}
function resetTimeout() {
    clearTimeout(timeoutId);
    timeoutId = setTimeout(hideElementsAndCursor, inactivityTimeout);
}
console.log("errorrrrrrrrrrrrrr 23");
document.addEventListener('mousemove', function() {
    resetTimeout();
    document.getElementById('slider_container_Id').classList.remove('hidden');
    document.getElementById('homeButtonsId').classList.remove('hidden');
    curr_track.style.cursor = 'auto';
    imageThumbnails.classList.remove('hidden');
});
document.addEventListener('mouseout', function() {
    resetTimeout();
});
resetTimeout();


cImageRotation=0;
//Image functions
console.log("error 200")
var zoomSliderV=document.getElementById("zoomSliderId").value;
function zoomSlider(){
  zoomSliderV=document.getElementById("zoomSliderId").value;
  if(zoomSliderV==1){
    elSlikaEl.style.display="flex";}
  if(zoomSliderV>1){
    elSlikaEl.style.display="flex";
  }
  document.getElementById(activePaneId).children[0].style.transform="rotate("+cImageRotation+"deg) scale("+zoomSliderV+")";
}
function rotatePicture(){
  if(cImageRotation==360){
    cImageRotation=0;
    console.log("rotate set 0");
  }
  cImageRotation+=90;
  if(cImageRotation==90 || cImageRotation==270){
    console.log("rotate 90 or 270");
     document.getElementById(activePaneId).children[0].style.width="100vh";
  }
  if(cImageRotation==0 || cImageRotation==180 || cImageRotation==360){
    console.log("rotate 0 or 180");
     document.getElementById(activePaneId).children[0].style.width="auto";
  }
   document.getElementById(activePaneId).children[0].style.transform="rotate("+cImageRotation+"deg) scale("+zoomSliderV+")";
}
// Image pane states
  const paneStates = {
    pane0: { rotation: 0, zoom: 1, index: 0, scrollX: 0, scrollY: 0 }
  };
 function readPhotosInFolder(folderPath){
fs.readdir(folderPath, (err, files) => {
      if (err) {
        console.error('Error reading folder:', err);
        return;
      }
      console.log('Files in folder:', files);
      files.forEach(file => {
        if(file.includes('.jpg') || file.includes('.jpeg') || file.includes('.gif') || file.includes('.webp') || file.includes('avif') || file.includes('png') || file.includes('svg')){
        let photoFPath=folderPath+file;
        let theFile=newFileObj(file,photoFPath,'image');
        track_list.push(theFile);  
        }
        });
    });
  }
  //First pane
   document.getElementById("pane0").addEventListener('click', () => {
          activePaneId = 'pane0';
          highlightActivePane();
        });
function splitView() {
      const workspace = document.getElementById('elSlikaId');
      
      if (paneCount < 3) {
        paneCount++;
        const newPaneId = `pane${paneCount - 1}`;
        const newPane = document.createElement('div');
        newPane.className = 'image-pane';
        newPane.id = newPaneId;
        const img = document.createElement('img');
        img.src = track_list[track_index]?.path || '';
        newPane.appendChild(img);
        workspace.appendChild(newPane);
        
        // Initialize state for new pane
        paneStates[newPaneId] = { rotation: 0, zoom: 1, index: track_index, scrollX: 0, scrollY: 0 };
        
        // Make pane clickable to set as active
        newPane.addEventListener('click', () => {
          activePaneId = newPaneId;
          highlightActivePane();
        });
        
        activePaneId = newPaneId;
        highlightActivePane();
      }
    }

    function closePane(paneId) {
      if (paneCount === 1) return; // Don't close the last pane
      
      const pane = document.getElementById(paneId);
      pane.remove();
      delete paneStates[paneId];
      paneCount--;
      
      // Set first pane as active
      activePaneId = 'pane0';
      highlightActivePane();
    }

    function highlightActivePane() {
      document.querySelectorAll('.image-pane').forEach(pane => {
        if (pane.id === activePaneId) {
          pane.style.border = '2px solid #00ff672e';
        } else {
          pane.style.border = 'none';
        }
      });
    }
loadPicture();
    </script>
</body>

</html>